
<pep-page-layout [addPadding]="false" *ngIf="collectionLoaded">
    <ng-container pep-top-area>
        <pep-top-bar [title]="mode == 'Add' ? ('Collection_Add_Title' | translate) : ('Collection_Edit_Title' | translate: {collection_name: collectionName})">
            <div header-start-content>
                <!-- <pep-button class="pep-spacing-element" (buttonClick)="goBack()" [iconName]="'arrow_left_alt'"></pep-button> -->
            </div>
            <div header-end-content>
                <pep-button class="pep-spacing-element" [value]="'Back_to_list' | translate" (buttonClick)="goBack()"></pep-button> 
                <pep-button class="pep-spacing-element" [value]="mode == 'Add' ? ('Save' | translate) : ('Update' | translate)" [styleType]="'strong'" (buttonClick)="saveClicked()"></pep-button>
            </div>
        </pep-top-bar>
    </ng-container>

    <ng-container pep-main-area>  
        <div class="flex">
            <pep-textbox
                [(value)]="collection.Name"
                [label]="'Key' | translate"
                type="text"
                [mandatory]="false"
                [disabled]="!emptyCollection"
            ></pep-textbox>
            <pep-textbox
                [(value)]="collection.Description"
                [label]="'Description' | translate"
                type="text"
                [mandatory]="false"
                [disabled]="false"
            ></pep-textbox>
        </div>
        <div class="genericListContainer">
            <pep-generic-list class="generic-list"
                [title] = "'Collection_Fields_Title' | translate"
                [showTopBar]="true" 
                [dataSource]="fieldsDataSource" 
                [inline]="true"
                [actions]="fieldsActions"
                [addPadding]="false"
                [showSearch]="false"
                [uuidMapping]="'Key'"
                >
                <ng-container right-buttons>
                    <pep-button 
                        class="pep-spacing-element"
                        [sizeType]="'sm'" 
                        [value]="'Add' | translate" 
                        [styleType]="'strong'" 
                        (buttonClick)="openFieldForm(EMPTY_OBJECT_NAME)"
                    ></pep-button>
                </ng-container>
            </pep-generic-list>
        </div>
        <div class="flex">
            <pep-select
                [(value)]="collection.DocumentKey.Type"
                [label]="'DocumentKey_Select_Title' | translate"
                type="select"
                [mandatory]="false"
                [disabled]="!emptyCollection"
                xAlignment="left"
                [options]="documentKeyOptions"
                [showTitle]="true"
                [emptyOption]="false"
                (valueChange)="documentKeyTypeChanged($event)"
            ></pep-select>
            <pep-textbox
                [visible]="collection.DocumentKey.Type === 'Composite'"
                [(value)]="collection.DocumentKey.Delimiter"
                [label]="'DocumenyKey_Delimiter_Title' | translate"
                type="text"
                [mandatory]="false"
                [disabled]="!emptyCollection"
            ></pep-textbox>
        </div>
        <div class="genericListContainer" *ngIf="collection.DocumentKey.Type === 'Composite'">
            <pep-generic-list class="generic-list"
                [title] = "'UID_Fields_Title' | translate"
                [showTopBar]="true" 
                [dataSource]="uidFieldsDataSource" 
                [inline]="true"
                [actions]="uidFieldsActions"
                [addPadding]="false"
                [showSearch]="false"
                [uuidMapping]="'Key'"
                >
                <ng-container right-buttons>
                    <pep-button 
                        *ngIf="emptyCollection"
                        class="pep-spacing-element"
                        [sizeType]="'sm'" 
                        [value]="'Add' | translate" 
                        [styleType]="'strong'" 
                        (buttonClick)="openUidFieldsForm()"
                    ></pep-button>
                </ng-container>
            </pep-generic-list>
        </div>
    </ng-container>
</pep-page-layout>

<ng-template #UidFieldForm> 
    <pep-dialog [showHeader]="false">
        <ng-container pep-dialog-content>
            <pep-select
                [(value)]="fieldKey"
                [label]="'UidFields_SelectLabel' | translate"
                type="select"
                [options]="collectionFields"
                [emptyOption]="false"
            ></pep-select>
        </ng-container>
        <ng-container pep-dialog-actions>
            <div class="pep-spacing-element-negative">         
                <pep-button 
                    class="pep-spacing-element"
                    [sizeType]="'md'" 
                    [value]="'Save' | translate" 
                    [styleType]="'strong'" 
                    (buttonClick)="saveField()"
                ></pep-button>
            </div>
        </ng-container>
    </pep-dialog>
</ng-template>

